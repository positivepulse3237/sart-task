<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SART Experiment</title>
  <style>
    body { background:#000; color:#fff; font-family:Arial,sans-serif; margin:0; }
    .wrap { max-width:800px; margin:0 auto; padding:24px; }
    button { padding:10px 16px; font-size:16px; cursor:pointer; }
    .ok { color:#64ffda; }
    .err { color:#ff6b6b; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>SART Experiment</h1>
    <p>Run your experiment here. When it finishes, send the results to the server.</p>

    <h3>Quick end‑to‑end test</h3>
    <p>Click to simulate a result submission (without jsPsych) to confirm storage works.</p>
    <button id="run">Run test submission</button>
    <pre id="log"></pre>

    <script>
      const log = document.getElementById('log');
      document.getElementById('run').onclick = async () => {
        const payload = {
          participant_id: 'demo-' + Math.random().toString(36).slice(2, 8),
          timestamp: new Date().toISOString(),
          score: Math.floor(Math.random()*100),
          notes: 'demo submission'
        };

        try {
          const res = await fetch('/api/submit', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ data: payload })
          });
          const json = await res.json();
          if (!res.ok) throw new Error(json.error || 'Submit failed');
          log.innerHTML = 'Submitted ✓\n' + JSON.stringify(payload, null, 2);
          log.className = 'ok';
        } catch (e) {
          log.innerHTML = 'Error: ' + e.message;
          log.className = 'err';
        }
      };

      // Replace this with your jsPsych on_finish when your experiment is ready:
      // on_finish: async () => {
      //   const fullData = jsPsych.data.get().values();
      //   const summary = { participant_id, score, timestamp: new Date().toISOString(), data: fullData };
      //   await fetch('/api/submit', {
      //     method: 'POST',
      //     headers: { 'Content-Type': 'application/json' },
      //     body: JSON.stringify({ data: summary })
      //   });
      // }
    </script>
  </div>
</body>
</html>
