<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SART Task Experiment</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; }
        button { padding: 15px 30px; font-size: 18px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>SART Task Experiment</h1>
    <p>Do your experiment here...</p>
    
    <button onclick="finishExp()">Submit Results</button>
    
    <p id="status" style="margin-top: 20px; color: gray;"></p>

    <script>
        async function finishExp() {
            // -----------------------------------------
            // REPLACE THIS WITH YOUR REAL EXPERIMENT DATA
            // -----------------------------------------
            const subjectId = "User_" + Math.floor(Math.random() * 1000);
            const score = Math.floor(Math.random() * 100); 
            const dataLine = `${subjectId}, ${score}, ${new Date().toISOString()}`;
            // -----------------------------------------

            const status = document.getElementById('status');
            status.innerText = "Saving data, please wait...";

            try {
                const response = await fetch('/api/save', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ content: dataLine })
                });

                if (response.ok) {
                    status.innerText = "✅ Success! Data saved.";
                    status.style.color = "green";
                } else {
                    status.innerText = "❌ Error saving data.";
                    status.style.color = "red";
                }
            } catch (e) {
                status.innerText = "❌ Network Error.";
            }
        }
    </script>
</body>
</html>
